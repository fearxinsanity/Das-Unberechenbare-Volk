<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Slider?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<StackPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="de.schulprojekt.duv.view.DashboardController"
           prefHeight="800.0" prefWidth="1280.0" styleClass="root-pane">

    <Region styleClass="grid-background" opacity="0.6" />

    <Label text="CLASSIFIED // TOP SECRET" styleClass="classified-watermark" mouseTransparent="true" opacity="0.1"/>

    <BorderPane pickOnBounds="false">
        <top>
            <VBox>
                <HBox alignment="CENTER_RIGHT" spacing="20" style="-fx-padding: 5 20 0 0; -fx-background-color: rgba(0,0,0,0.5);">
                    <Label text="SIM.CORE: ONLINE" styleClass="hud-text, hud-text-highlight"/>
                    <Label text="ENCRYPTION: AES-256" styleClass="hud-text"/>
                    <Label text="SECURE_CONN_ESTABLISHED" styleClass="hud-text"/>
                </HBox>
                <VBox styleClass="top-bar">
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <ImageView fitHeight="40.0" preserveRatio="true" opacity="0.9">
                            <image>
                                <Image url="@../Pictures/DUV_Logo.png" />
                            </image>
                        </ImageView>

                        <Label text="[ SYSTEM: DAS UNBERECHENBARE VOLK ]" styleClass="app-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="timeStepLabel" text="Status: STANDBY" styleClass="status-label"/>
                        <Separator orientation="VERTICAL" />
                        <Button fx:id="startButton" text="â–¶ EXECUTE" onAction="#handleStartSimulation"/>
                        <Button fx:id="pauseButton" text="â¸ FREEZE" onAction="#handlePauseSimulation" disable="true"/>
                        <Button fx:id="resetButton" text="â†º REBOOT" onAction="#handleResetSimulation" disable="true"/>
                        <Button fx:id="statsButton" text="ðŸ“Š INTEL" onAction="#handleShowStatistics" style="-fx-base: #222;"/>
                        <Button fx:id="parliamentButton"
                                text="PARLIAMENT"
                                onAction="#handleShowParliament"
                                styleClass="action-button">
                        </Button>
                    </HBox>
                </VBox>
            </VBox>
        </top>

        <left>
            <ScrollPane fitToWidth="true" fitToHeight="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED"
                        style="-fx-background-color: transparent; -fx-background: transparent; -fx-padding: 0;">
                <BorderPane.margin>
                    <Insets top="15" left="15" bottom="15" right="0"/>
                </BorderPane.margin>
                <content>
                    <VBox fx:id="leftSidebar" spacing="15" styleClass="sidebar" prefWidth="300" minHeight="0">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>

                        <Label text=">> CONFIGURATION" styleClass="section-title"/>
                        <Separator style="-fx-opacity: 0.3;"/>

                        <VBox spacing="5">
                            <Label text="POPULATION SIZE" styleClass="control-label"/>
                            <HBox spacing="5" alignment="CENTER_LEFT">
                                <Button text="-" onAction="#handleVoterCountDecrement" prefWidth="35"/>
                                <TextField fx:id="voterCountField" text="100000" HBox.hgrow="ALWAYS" onAction="#handleParameterChange" alignment="CENTER"/>
                                <Button text="+" onAction="#handleVoterCountIncrement" prefWidth="35"/>
                            </HBox>
                        </VBox>

                        <VBox spacing="5">
                            <Label text="NUMBER OF PARTIES" styleClass="control-label"/>
                            <HBox spacing="5" alignment="CENTER_LEFT">
                                <Button text="-" onAction="#handlePartyCountDecrement" prefWidth="35"/>
                                <TextField fx:id="partyCountField" text="5" HBox.hgrow="ALWAYS" alignment="CENTER" editable="false"/>
                                <Button text="+" onAction="#handlePartyCountIncrement" prefWidth="35"/>
                            </HBox>
                        </VBox>

                        <Separator style="-fx-opacity: 0.2;"/>

                        <VBox spacing="12">
                            <VBox spacing="2">
                                <Label text="MEDIA INFLUENCE (%)" styleClass="control-label"/>
                                <Slider fx:id="mediaInfluenceSlider" min="0" max="100" value="65" onMouseReleased="#handleParameterChange"/>
                            </VBox>
                            <VBox spacing="2">
                                <Label text="VOTER VOLATILITY (%)" styleClass="control-label"/>
                                <Slider fx:id="mobilityRateSlider" min="0" max="100" value="35" onMouseReleased="#handleParameterChange"/>
                            </VBox>
                            <VBox spacing="2">
                                <Label text="PARTY LOYALTY (AVG)" styleClass="control-label"/>
                                <Slider fx:id="loyaltyMeanSlider" min="0" max="100" value="50" onMouseReleased="#handleParameterChange"/>
                            </VBox>
                            <VBox spacing="2">
                                <Label text="CAMPAIGN BUDGET (â‚¬)" styleClass="control-label"/>
                                <TextField fx:id="budgetField" text="500000" onAction="#handleParameterChange"/>
                            </VBox>
                            <VBox spacing="2">
                                <Label text="SCANDAL RISK (%)" styleClass="terminal-value-alert"/>
                                <HBox spacing="5" alignment="CENTER_LEFT">
                                    <Button text="-" onAction="#handleScandalChanceDecrement" prefWidth="35"/>
                                    <TextField fx:id="scandalChanceField" text="5.0" HBox.hgrow="ALWAYS" alignment="CENTER" onAction="#handleParameterChange"/>
                                    <Button text="+" onAction="#handleScandalChanceIncrement" prefWidth="35"/>
                                </HBox>
                            </VBox>
                            <VBox spacing="2">
                                <Label text="CHAOS FACTOR (Variance)" styleClass="control-label"/>
                                <Slider fx:id="randomRangeSlider" min="0.1" max="5.0" value="1.0" onMouseReleased="#handleParameterChange"/>
                            </VBox>
                        </VBox>

                        <Separator style="-fx-opacity: 0.2;"/>

                        <VBox spacing="5">
                            <Label text="SIMULATION SPEED" styleClass="control-label"/>
                            <HBox spacing="5" alignment="CENTER">
                                <Button text="1x" onAction="#handleSpeed1x" prefWidth="50"/>
                                <Button text="2x" onAction="#handleSpeed2x" prefWidth="50"/>
                                <Button text="4x" onAction="#handleSpeed4x" prefWidth="50"/>
                            </HBox>
                        </VBox>

                        <Region VBox.vgrow="ALWAYS"/>
                        <Button text="[ RANDOMIZE DATA ]" onAction="#handleRandomize" maxWidth="Infinity" style="-fx-base: #333; -fx-margin-bottom: 5;"/>
                        <Button text="[ APPLY UPDATE ]" onAction="#handleParameterChange" maxWidth="Infinity" style="-fx-base: #222;"/>
                    </VBox>
                </content>
            </ScrollPane>
        </left>

        <center>
            <BorderPane>
                <center>
                    <StackPane fx:id="animationPane" style="-fx-background-color: transparent;" minWidth="0" minHeight="0">
                        <BorderPane.margin>
                            <Insets top="15" left="15" right="15" bottom="0"/>
                        </BorderPane.margin>
                    </StackPane>
                </center>
                <bottom>
                    <VBox styleClass="sidebar" style="-fx-padding: 5;">
                        <BorderPane.margin>
                            <Insets top="15" left="15" right="15" bottom="15"/>
                        </BorderPane.margin>
                        <Label text="LIVE_INTEL // SCANDAL_TICKER" styleClass="control-label" style="-fx-padding: 0 0 5 10;"/>
                        <ScrollPane fx:id="scandalTickerScroll" fitToHeight="true" vbarPolicy="NEVER" hbarPolicy="AS_NEEDED"
                                    style="-fx-background-color: transparent; -fx-background: transparent;"
                                    minHeight="80.0" prefHeight="100.0">
                            <content>
                                <HBox fx:id="scandalTickerBox" alignment="CENTER_LEFT" spacing="20.0" style="-fx-padding: 10;">
                                </HBox>
                            </content>
                        </ScrollPane>
                    </VBox>
                </bottom>
            </BorderPane>
        </center>

        <right>
            <VBox fx:id="rightSidebar" spacing="15" styleClass="sidebar" prefWidth="320">
                <BorderPane.margin>
                    <Insets top="15" right="15" bottom="15" left="0"/>
                </BorderPane.margin>

                <VBox spacing="5" VBox.vgrow="NEVER">
                    <Label text=">> INTEL_LOG" styleClass="section-title"/>
                    <Pane fx:id="eventFeedPane" prefHeight="180" style="-fx-background-color: rgba(0,0,0,0.2);"/>
                </VBox>

                <Separator style="-fx-opacity: 0.3;"/>

                <VBox VBox.vgrow="ALWAYS" spacing="5">
                    <Label text=">> TREND_ANALYSIS" styleClass="section-title"/>
                    <LineChart fx:id="historyChart" createSymbols="false" animated="false" VBox.vgrow="ALWAYS" legendVisible="false">
                        <xAxis><NumberAxis label="TICKS" tickLabelFill="white"/></xAxis>
                        <yAxis><NumberAxis label="VOTES" tickLabelFill="white"/></yAxis>
                    </LineChart>
                </VBox>

                <VBox spacing="2" style="-fx-opacity: 0.6;">
                    <Label text="KEY:" style="-fx-font-size: 10px; -fx-font-weight: bold; -fx-text-fill: #D4AF37;"/>
                    <Label text="[â– ] FACTION_CORE" style="-fx-font-size: 10px; -fx-text-fill: #888;"/>
                    <Label text="[+] CROSSHAIR: ACTIVE" style="-fx-font-size: 10px; -fx-text-fill: #888;"/>
                    <Label text="--> DATA_PACKET: TRANSFER" style="-fx-font-size: 10px; -fx-text-fill: #888;"/>
                </VBox>
            </VBox>
        </right>

        <bottom>
            <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-padding: 0 0 10 20;">
                <Label text="SYS.ID: DUV-2026-X" styleClass="hud-text"/>
                <Label text="MODE: TACTICAL_VIEW" styleClass="hud-text, hud-text-highlight"/>
            </HBox>
        </bottom>
    </BorderPane>

    <Region styleClass="crt-overlay" mouseTransparent="true" />

</StackPane>