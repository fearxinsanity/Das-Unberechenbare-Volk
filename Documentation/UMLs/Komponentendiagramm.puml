@startuml
skinparam componentStyle rectangle
skinparam linetype polyline
skinparam nodesep 120
skinparam ranksep 140
skinparam packagePadding 25
skinparam ArrowFontSize 10

' ===== PRESENTATION LAYER =====
package "Presentation Layer" #LIGHTPINK {
    component [JavaFX Application\n<<Main>>] as MainApp #LIGHTCORAL

    package "View Controllers" {
        component [Dashboard\nController] as Dashboard #PLUM
        component [Start\nController] as Start #PLUM
        component [Statistics\nController] as Statistics #PLUM
        component [Parliament\nController] as Parliament #PLUM
    }

    package "View Components" {
        component [FXML\nViews] as FXML #THISTLE
        component [CSS\nStylesheets] as CSS #THISTLE
    }
}

'---------------------------------------------------

' ===== APPLICATION LAYER =====
package "Application Layer" #LIGHTSALMON {
    component [Simulation\nController] as SimController #CORAL
}

'---------------------------------------------------

' ===== BUSINESS LOGIC LAYER =====
package "Business Logic Layer" #LIGHTBLUE {

    package "Core Engine" {
        component [Simulation\nEngine] as Engine #DEEPSKYBLUE
        component [Simulation\nState] as State #DEEPSKYBLUE
        component [Simulation\nParameters] as Params #DEEPSKYBLUE
    }

    package "Domain Models" #E6F3FF {
        component [Party\nManagement] as PartyMgmt #LIGHTGREEN
        component [Voter\nManagement] as VoterMgmt #LIGHTCORAL
        component [Scandal\nSystem] as ScandalSys #LIGHTYELLOW
        component [Voter\nBehavior] as VoterBehavior #LIGHTCORAL
        component [Impact\nCalculator] as ImpactCalc #LIGHTYELLOW
    }

    package "Data Models" #E6F3FF {
        component [Party] as PartyEntity #PALEGREEN
        component [Scandal] as ScandalEntity #PALEGOLDENROD
        component [VoterType] as VoterTypeEnum #PINK
    }
}

'---------------------------------------------------

' ===== UTILITY & DATA LAYERS =====
package "Utility Layer" #PALEGOLDENROD {
    package "Configuration" {
        component [Party\nConfig] as PartyConf #KHAKI
        component [Simulation\nConfig] as SimConf #KHAKI
        component [Scandal\nConfig] as ScandalConf #KHAKI
        component [Voter\nConfig] as VoterConf #KHAKI
    }

    package "Validation" {
        component [Parameter\nValidator] as Validator #LIGHTGOLDENRODYELLOW
        component [Validation\nMessage] as ValMsg #LIGHTGOLDENRODYELLOW
    }
}

package "Data Access Layer" #WHEAT {
    component [CSV\nLoader] as CSVLoader #KHAKI
    component [Distribution\nProvider] as DistProvider #LIGHTCYAN
}

'---------------------------------------------------

' ===== EXTERNAL RESOURCES =====
package "External Resources" #LIGHTGRAY {
    database "CSV\nFiles" as CSVFiles
    database "FXML\nResources" as FXMLResources
    database "Style\nResources" as StyleResources
}

'===================================================
' ===== RELATIONSHIPS =====
'===================================================

' Presentation Layer
MainApp -down-> Dashboard : creates
MainApp -down-> Start : creates
MainApp -right-> FXML : loads
MainApp -right-> CSS : applies

Dashboard -down-> Statistics : delegates
Dashboard -down-> Parliament : delegates
Dashboard .down.> FXML : binds
Start .down.> FXML : binds

' Application Layer
Dashboard -down-> SimController : invokes

SimController -down-> Engine : orchestrates
SimController -right-> Validator : validates
SimController .right.> ValMsg : uses

' Core Engine
Engine -down-> State : manages
Engine -down-> Params : uses

' Core to Domain (separate lines for clarity)
Engine -[hidden]down-> PartyMgmt
Engine -down-> PartyMgmt : coordinates
Engine -down-> VoterMgmt : coordinates
Engine -down-> ScandalSys : coordinates
Engine -down-> VoterBehavior : invokes
Engine -down-> ImpactCalc : uses

' Core to Data Access
Engine -right-> DistProvider : uses
Engine -right-> CSVLoader : loads

' Domain to Entities
PartyMgmt -down-> PartyEntity : manages
ScandalSys -down-> ScandalEntity : schedules
VoterMgmt -down-> VoterTypeEnum : uses

' Domain to Data Access
VoterMgmt .right.> DistProvider : initializes
ScandalSys .right.> DistProvider : uses
PartyMgmt .down.> CSVLoader : loads

' Domain Internal
VoterBehavior .left.> VoterMgmt : processes
VoterBehavior .down.> PartyEntity : evaluates
ImpactCalc .left.> ScandalEntity : calculates

' Configuration Usage
PartyEntity .up.> PartyConf : validates
Engine .right.> SimConf : uses
ImpactCalc .right.> ScandalConf : uses
VoterBehavior .right.> VoterConf : uses

' External Resources
CSVLoader -down-> CSVFiles : reads
FXML -down-> FXMLResources : loads
CSS -down-> StyleResources : loads

@enduml
